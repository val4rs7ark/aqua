<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.GeneralMapper">

<!-- 	<resultMap type = "java.util.Map" id="rMap">
		<result jdbcType="VARCHAR" javaType="java.lang.String" property="mem_id"/>
	</resultMap> -->
	<select id="invenList" parameterType="map" resultType="map">
	select INVEN_NO,INVEN_COUNT,USE_DATE,INVEN_REGDATE,BUY_UNITPRICE,BUY_DATE        
           ,iv.IVGROUP_CODE IVGROUP_CODE,IVG.IVGROUP_NAME IVGROUP_NAME,IVG.IVGROUP_BUNRYU IVGROUP_BUNRYU
           ,IVG.IVGROUP_SIZE IVGROUP_SIZE,iv.DEPT_CODE DEPT_CODE,BUY_TOTALPRICE,iv.EMPNO
           ,emp.emp_name emp_name,INVEN_GUBUN,inven_status  
	  from inventory iv,invengroup ivg,emp
	  where iv.ivgroup_code=ivg.ivgroup_code
	    and iv.empno = emp.empno           
	</select>
<!-- 	<insert id="invenAdd" parameterType="map">
	insert into inventory(inven_no,inven_count,use_date,inven_regdate,buy_unitprice,buy_date,ivgroup_code,dept_code,buy_totalprice,empno,inven_gubun,inven_status)
	values ((select max(inven_no)+1 from inventory),#{inven_count},
		#{use_date},to_char(sysdate,'yyyy-mm-dd'),#{buy_unitprice},#{buy_date},
		'i001','d001_1',#{buy_totalprice},'a1234','구매','승인대기')
	</insert> -->
	<insert id="invenAdd" parameterType="map">
	insert into inventory(inven_no,inven_count,use_date,inven_regdate,buy_unitprice,buy_date,ivgroup_code,dept_code,buy_totalprice,empno,inven_gubun,inven_status)
	values (#{inven_no},#{inven_count},#{use_date},to_char(sysdate,'yyyy-mm-dd'),#{buy_unitprice},#{buy_date},'i001','d001_1',#{buy_totalprice},'a1234','구매','승인대기')
	</insert>
	<insert id="invenAdd2" parameterType="map" statementType="CALLABLE">
	{call proc_invenadd(#{inven_count,mode=IN, jdbcType=NUMERIC, javaType=java.lang.Integer}
	  				  ,#{use_date,mode=IN, jdbcType=VARCHAR, javaType=java.lang.String}
	  				  ,#{buy_unitprice,mode=IN, jdbcType=NUMERIC, javaType=java.lang.Integer}
	  				  ,#{buy_date,mode=IN, jdbcType=VARCHAR, javaType=java.lang.String}
	  				  ,#{buy_totalprice,mode=IN, jdbcType=NUMERIC, javaType=java.lang.Integer})} 
	</insert>
	<select id="getInven_no" parameterType="map" resultType="int">
	select nvl(max(inven_no),0)+1 from inventory
	</select>
	<select id="getInvenTotal" parameterType="map" resultType="int">
	select count(inven_no) from inventory	
	</select>
	<select id="getInvenGroupTotal" parameterType="map" resultType="int">
	select count(ivgroup_code) from invengroup
	</select>
	<select id="invengroupList" parameterType="map" resultType="map">
	select IVGROUP_CODE,IVGROUP_NAME,IVGROUP_SIZE,IVGROUP_BUNRYU 
	  from invengroup
	</select>
	
<!-- 	<insert id="invenAdd" parameterType="map"> =====>#{use_date,jdbcType=VARCHAR},to_char(#{buy_date,jdbcType=VARCHAR},'yyyy.mm.dd')
	insert into inventory(inven_no,inven_count,use_date,inven_regdate,buy_unitprice,buy_date,ivgroup_code,dept_code,buy_totalprice,empno,inven_gubun)
	values ((select count(inven_no)+1 from inventory),#{inven_count},
		#{use_date},to_char(sysdate,'yyyy.mm.dd'),#{buy_unitprice},#{buy_date},
		#{ivgroup_code},#{dept_code},#{buy_totalprice},#{empno},
		#{inven_gubun})
	</insert> -->

</mapper>